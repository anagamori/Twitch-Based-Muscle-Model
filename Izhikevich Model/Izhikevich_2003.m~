%==========================================================================
% Izhikevich_2003.m
% Author: Akira Nagamori
% Last update: 6/18/19
% Reference:
%   Izhikevich 2003 
%==========================================================================

close all
clear all
clc

%%
Fs = 10000;
time = 0:1/Fs:5;
%%
I = zeros(1,length(time));
I(2*Fs+1:end) = 10;
%% Model parameters
a= 0.02; %[0.02*ones(Ne,1); 0.02+0.08*ri];
b= 0.2; %[0.2*ones(Ne,1); 0.25-0.05*ri];
c= -65; %[-65+15*re.^2; -65*ones(Ni,1)];
d= 2; %[8-6*re.^2; 2*ones(Ni,1)];

%%
S=[0.5*rand(Ne+Ni,Ne), -rand(Ne+Ni,Ni)];

%% Initial Conditions
v=-65; %*ones(Ne+Ni,1); % Initial values of v
u=b.*v; % Initial values of u

%%
binary = zeros(1,lengthj)

for t = 1:length(time) 
I=[5*randn(Ne,1);2*randn(Ni,1)]; % thalamic input

fired=find(v>=30); % indices of spikes
firings=[firings; t+0*fired,fired];
v(fired)=c(fired);
u(fired)=u(fired)+d(fired);
I=I+sum(S(:,fired),2);

v_dot = (0.04*v.^2+5*v+140-u+I(t)); % step 0.5 ms
v = v_dot*1/Fs + v;

u_dot = a.*(b.*v-u);
u = u_dot*1/Fs + u; % stability


end

plot(firings(:,1),firings(:,2),'.');
