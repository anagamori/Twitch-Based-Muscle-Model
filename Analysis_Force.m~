close all
clear all
clc

dataFolder = '/Users/akiranagamori/Documents/GitHub/SDN Data';
codeFolder = '/Users/akiranagamori/Documents/GitHub/Twitch-Based-Muscle-Model';
amp_vec = 0.1:0.1:1;

Fs = 1000;

mean_Force_all = zeros(1,length(amp_vec));
SD_Force_all = zeros(1,length(amp_vec));
SD_Force_SD_all = zeros(1,length(amp_vec));
CoV_Force_all = zeros(1,length(amp_vec));

for i = 1:length(amp_vec)
    cd (dataFolder)
    load(['Data' num2str(i)],'Data')
    cd (codeFolder)
    
    mean_Force = zeros(1,10);
    SD_Force = zeros(1,10);
    CoV_Force = zeros(1,10);
    
    for j = 1:10
        output = Data{j};
        Force = sum(output.Force(:,5*Fs+1:end));
        mean_Force(j) = mean(Force);
        SD_Force(j) = std(Force);
        CoV_Force(j) = SD_Force(j)/mean_Force(j);
    end
    
    mean_Force_all(i) = mean(mean_Force);
    SD_Force_all(i) = mean(SD_Force);
    SD_Force_SD_all(i) = std(SD_Force);
    CoV_Force_all(i) = mean(CoV_Force);
    
end

mean_Force_vec = mean(mean_Force_all,2);

figure(1)
plot(amp_vec,mean_Force_all)

figure(3)
errorbar(amp_vec, mean(SD_Force_all,2)./mean_Force_vec(end)*100,std(SD_Force_all,[],2)./mean_Force_vec(end)*100,'-','Color',[0.078,0,0.831],'LineWidth',2,'Marker','o','MarkerFaceColor',[0.078,0,0.831])
xlabel('Excitation Level (%)','FontSize',14,'fontweight','bold')
ylabel('SD (%)','FontSize',14,'fontweight','bold')
xlim([0 105])