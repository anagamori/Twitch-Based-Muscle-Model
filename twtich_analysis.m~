%--------------------------------------------------------------------------
% twitch_analysis.m
% Author: Akira Nagamori
% Last update: 10/16/18
% Descriptions: analyze effects of force-dependent time constant on contraction time and
% half relaxation time 
%--------------------------------------------------------------------------
close all
clc

Fs = 1000; %sampling frequency
time = 0:1/Fs:5; %simulation time
stim = zeros(1,length(time)); %stimulus train
stim(1*Fs) = 1; %single pulse stimulus

a = 10;
b = 10;

h = exp(-a*time); %first linear filter
g = exp(-b*time); %second linear filter whose time constant depends on the force level (Bobet & Stein, 1998)

q = conv(stim,h); %convolution
f = conv(q,g);

[pks,locs_peak] = max(f);
CT = locs_peak-1*Fs;

peak_half = pks/2;
[~,locs_hrt] = min(abs(f(locs_peak:end)-peak_half));
HRT = locs_peak+locs_hrt;

figure(1)
plot(time,f(1:length(time)))
hold on 
plot([time(CT) time(CT)],)






