
Fs = 100;
time = 0:1/Fs:5;

f
rng shuffle

u = zeros(1,length(time));
u(2*Fs+1:end) = 0.5;
r = normrnd(0,1,[1,length(time)]);
omega_c = 0.5;

tau_1 = 0.04;
tau_2 = 0.04;

f = 0;
f_dot = 0;

u_vec = zeros(1,length(time));
f_vec = zeros(1,length(time));

for t = 1:length(time)
    u_t = u(t)*omega_c*r(t)+u(t);
    f_ddot = (u_t - f - (tau_1+tau_2)*f_dot)/(tau_1*tau_2);
    f_dot = f_ddot/Fs + f_dot;
    f = f_dot/Fs + f;
    
    u_vec(t) = u_t;
    f_vec(t) = f;
end

figure
subplot(2,1,1)
plot(time,u)
hold on 
plot(time,u_vec)
subplot(2,1,2)
plot(time,f_vec)