close all
clc
clear all

code_folder = '/Users/akiranagamori/Documents/GitHub/Twitch-Based-Muscle-Model/Development_Code';
data_folder = '/Users/akiranagamori/Documents/GitHub/Twitch-Based-Muscle-Model/Model Parameters/Model_11';

N_MU = 200;
CT = zeros(N_MU,1);
t2t = zeros(N_MU,1);
FR_half = zeros(N_MU,1);
Af = zeros(N_MU,52);
fusion = zeros(N_MU,52);
f_exp = [2 4 6 8 10 12.5 14 16 18 20 22 25 28 30 33.3 40 50 66.6 80 100];
force_exp = [2.5723 7.717 16.399 29.582 44.373 50.482 62.379 63.344 67.203 73.234 77.492 83.923 87.46 88.103 91.318 96.141 97.428 100.32 100 98.392];
[~,loc] = min(abs(force_exp-50));
f_half_exp = f_exp(loc);
fusion_exp = [-0.28169 17.465 36.62 58.31 74.93 85.915 90.141 92.394 94.93 96.056 96.62 97.465 97.465 97.746 98.028 97.746 97.465 97.465 97.746 96.62];


for i = 1:N_MU

    cd('/Users/akiranagamori/Documents/Github/Twitch-Based-Muscle-Model/Development_Code/Data')
    load(['Data_' num2str(i)])
    cd(code_folder)

    CT(i) = Data{2,1};
    t2t(i) = Data{2,5};
    FR_half(i) = Data{2,6};
    
    Af(i,:) = Data{2,10}';
    fusion(i,:) = Data{2,11}';
    
    figure(3)
    plot(Data{2,9},Data{2,11}*100)
    xlim([0 3])
    hold on 
    
    figure(4)
    plot(Data{2,10},Data{2,11})
    hold on
end

figure(1)
plot(CT,t2t,'o')

figure(2)
plot(CT,1./FR_half*1000,'o')

figure(3)
 plot(f_exp./f_half_exp,fusion_exp,'LineWidth',1,'color','k')
 figure
%%
cd('/Users/akiranagamori/Documents/Github/Twitch-Based-Muscle-Model/Development_Code/Data')
save('CT','CT')
save('t2t','t2t')
save('FR_half','FR_half')
cd(code_folder)
