%==========================================================================
% fit_MU_length.m
% Author: Akira Nagamori
% Last update: 6/23/2020
% Descriptions:
%   Randomly adjust model parameters to generate temporary sets of
%   parameters
%==========================================================================


close all
clc
clear all

code_folder = '/Users/akira/Documents/GitHub/Twitch-Based-Muscle-Model/Development_Code';
data_folder = '/Users/akira/Documents/GitHub/Twitch-Based-Muscle-Model/Model Parameters/Model_11';

MU_type = 'slow';

simOpt = 0;
Fs = 2000;


MU_No = 1;
cd('/Users/akira/Documents/Github/Twitch-Based-Muscle-Model/Development_Code/Data')
load(['Data_' num2str(MU_No)])
cd(code_folder)

parameter = Data{2,12};
FR_half = Data{2,6};
FR_temp = 0.2:0.1:3;
FR_test = FR_temp*FR_half;

figure(1)
plot(Data{2,9},Data{2,10},'k','LineWidth',1)
xlim([0 3])
hold on 

r = rand(4,1000);
r = r*0.2;

Lce = 0.9;

for i = 1:size(r,2)

S = parameter(1);
C = parameter(2);
k_1 = parameter(3);
k_2 = parameter(4);
k_3 = parameter(5);
k_4 = parameter(6);
tau_1 = parameter(7);
tau_2 = parameter(8);
N = parameter(9);
K = parameter(10);
tau_3 = parameter(11);
alpha = parameter(12);

%%
r(1);
N = N + N*ptb; %r(3);
alpha = alpha - alpha*ptb;
K = K + K*ptb; %r(4);

param = [S,C,k_1,k_2,k_3,k_4,tau_1,tau_2,N,K,tau_3,alpha];


[Data] = MUModel_test_length(param,Lce,FR_half,FR_test,MU_type,1,simOpt,Fs);
figure(1)
plot(Data{2,9},Data{2,10},'LineWidth',1)


end
% cd('/Users/akira/Documents/Github/Twitch-Based-Muscle-Model/Development_Code/Data')
% save(['Data_temp_' num2str(MU_No)],'Data')
% cd(code_folder)
% clear Data

